<div materialize class="issueApproval blue-grey darken-2" *ngIf="courseService.selectedCourse.error !== undefined">
    <!-- Container to hold the fix approved and kebob menu buttons -->
    <div class="issueApproval__buttonContainer">
        <!-- Start Over Button -->
        <div class="issueApproval__button">
            <a class="modal-trigger waves-effect deep-orange-text text-accent-3 waves btn-flat" (click)="openModal('startOver')">
                <i class="material-icons left">refresh</i>
                Start Over
            </a>
        </div>
        <!-- Fix Approved Button -->
        <div class="issueApproval__button">
            <a href="#fixModal" class="modal-trigger waves-effect light-blue-text waves btn-flat" (click)="openModal('fixApproved')">
                <i class="material-icons left">build</i>
                Fix Approved Issues
            </a>
        </div>
    </div>

    <!-- The dropdown menu from the kebob menu -->
    <ul id="dropdown1" class="blue-grey darken-2 dropdown-content">
        <li>
            <a href="#fixModal" class="green-text text-accent-4 modal-trigger" (click)="openModal('approveAll')">
                Approve All Fixes
            </a>
        </li>
        <li>
            <a href="#fixModal" class="grey-text text-lighten-2 modal-trigger" (click)="openModal('unapproveAll')">
                Unapprove All Fixes
            </a>
        </li>
    </ul>

    <!-- The Kebob menu at the far right of the bottom bar -->
    <div>
        <a materialize="dropdown" [materializeParams]="[{constrain_width: false, alignment: 'left'}]" class="dropdown-button issueApproval_moreButton"
            data-activates="dropdown1">
            <i class="material-icons blue-grey-text text-lighten-3">more_vert</i>
        </a>
    </div>
</div>

<!-- Modal - Must stay beneath the main container -->
<div id="fixModal" class="modal" materialize="modal" [materializeActions]="modalActions">

    <div [ngSwitch]="getModal()">
        <div *ngSwitchCase="'approveAll'">
            <div class="modal-content">
                <h4>Approve Issues</h4>
                <p>
                    This will approve all unapproved issues.
                    <span class="red-text"> This will not approve "skipped" issues.</span>
                </p>

                <div style="margin-bottom:20px">
                    <h5 class="pad-20">Unapproved Issues</h5>
                    <app-stat-badge [statTitle]="'All Courses'" [statCount]="courseService.getTotalIssuecount()"></app-stat-badge>
                    <app-stat-badge [statTitle]="courseService.selectedCourse.course_code" [statCount]="courseService.getCourseIssueCount('untouched')"></app-stat-badge>
                </div>
            </div>
            <div class="modal-footer">
                <a class="modal-action modal-close waves-effect btn-flat blue-grey-text text-darken-3 left" (click)="closeModal()">Cancel</a>
                <a class="modal-action modal-close waves-effect btn-flat green-text" (click)="closeModal()">Approve All Courses</a>
                <a class="modal-action modal-close waves-effect btn-flat green-text" (click)="setApproved('approved')">Approve {{courseService.selectedCourse.course_code}}</a>
            </div>
        </div>

        <div *ngSwitchCase="'unapproveAll'">
            <div class="modal-content">
                <h4>Unapprove all fixes in {{courseService.selectedCourse.course_code}}?</h4>
                <p>This will unapprove all approved fixes in the current course.</p>
                <p>
                    <strong>Approved Fixes:</strong> {{courseService.getCourseIssueCount('approved')}}
                </p>
            </div>
            <div class="modal-footer">
                <a class="waves-effect btn-flat blue-grey-text" (click)="closeModal()">Cancel</a>
                <a class="modal-action modal-close waves-effect btn blue-grey" (click)="setApproved('untouched')">Unapprove All</a>
            </div>
        </div>

        <div *ngSwitchCase="'fixApproved'">
            <div class="modal-content">
                <h4>Fixed all approved issues?</h4>
                <p>This will attempt to fix all approved issues in ALL selected courses. Are you sure?</p>
                <p>
                    <strong>Approved Fixes:</strong> {{courseService.getCourseIssueCount('approved')}}
                </p>
            </div>
            <div class="modal-footer">
                <a class="waves-effect btn-flat blue-grey-text" (click)="closeModal()">Cancel</a>
                <a class="modal-action modal-close waves-effect btn blue" (click)="katanaService.fixIssues()">Fix Approved Issues</a>
            </div>
        </div>

        <div *ngSwitchCase="'startOver'">
            <div class="modal-content">
                <h4>Start Over?</h4>
                <p>This will take you back to the options page, and your progress will be lost.</p>
            </div>
            <div class="modal-footer">
                <a class="waves-effect btn-flat blue-grey-text" (click)="closeModal()">Cancel</a>
                <a class="modal-action modal-close waves-effect btn red" (click)="this.router.navigate(['categories', 'tools', this.toolService.selectedTool.id, 'options'])">Start Over</a>
            </div>
        </div>

        <div *ngSwitchDefault>
            <div class="modal-content">
                <h4>c( '_' c)</h4>
                <p>Something went wrong. Contact a Katana admin. Be entertained by the text-kirby above until the issue is resolved.</p>
            </div>
            <div class="modal-footer">
                <a class="waves-effect btn-flat blue-grey-text" (click)="closeModal()">Cancel</a>
            </div>
        </div>

    </div>
</div>
